<div class="flex flex-col pl-4 pr-4 gap-8 m-2">
    <!-- Header Section -->
    <div class="flex justify-between">
        <div class="flex flex-wrap items-center gap-4">
            <h1 class="font-semibold text-2xl">{{inventoryItem().description}}</h1>
            <h2>{{inventoryItem().id}}</h2>
            @if (inventoryItem().is_deinventoried) {
            <span class="text-red-500">Deinventarisiert</span>
            }
        </div>
        <a mat-button color="primary" [routerLink]="['/edit', inventoryItem().id]">Bearbeiten</a>
    </div>

    <!-- Divider -->
    <mat-divider></mat-divider>

    <!-- Details Section -->
    <div class="grid grid-cols-[max-content_1fr] gap-x-16">
        @for (field of inventoryItemColumns.keys(); track field) {
        <div class="p-2">{{inventoryItemColumns.get(field)}}</div>
        <div class="p-2">{{inventoryItemInternal.get(field)}}
            @if (field === 'price') {
            <span>€</span> }
        </div>
        }
    </div>

    <!-- Additional Data -->
    @for (id of panelIdNameMap.keys(); track id) {
    <mat-expansion-panel #Panels>
        <mat-expansion-panel-header>
            <mat-panel-title class="text-xl">{{panelIdNameMap.get(id)}}</mat-panel-title>
            @if (id === 'extensions') {
            <button mat-button class="mr-4" color="primary" (click)="addExtension()">Erweiterung hinzufügen</button>
            }
        </mat-expansion-panel-header>

        <!-- Panel content -->
        @if (panelContent.has(id) && panelContent.get(id)()!.length > 0) {
        @if (id === 'extensions') {
        <app-dynamic-list [tableContent]="panelContent.get(id)()" [columns]="panelColumnMaps.get(id)!"
            buttonText="Bearbeiten" (buttonClicked)="onClickExtension($event)" />
        } @else {
        <app-dynamic-list [tableContent]="panelContent.get(id)()" [columns]="panelColumnMaps.get(id)!" />
        }

        } @else if (id === 'tags' && tags.length > 0) {
        <mat-chip-set>
            @for (tag of tags; track tag) {
            <mat-chip role="listitem">{{tag.name}}</mat-chip>
            }
        </mat-chip-set>

        } @else {
        <p>Keine {{panelIdNameMap.get(id)}} vorhanden.</p>
        }

    </mat-expansion-panel>
    }

</div>
